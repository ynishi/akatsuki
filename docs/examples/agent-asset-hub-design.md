# Agent Asset Hub - è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

## 1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æœ¬å½“ã®ãƒ‹ãƒ¼ã‚ºï¼ˆWHY/WHO/WHATï¼‰

**WHYï¼ˆãªãœå¿…è¦ã‹ï¼‰:**
- LLM/Agenté–‹ç™ºã«ãŠã„ã¦ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ»ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ»çŸ¥è­˜ãŒæ•£åœ¨ã—ã¦ã„ã‚‹
- ComfyUIã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¯ç”»åƒãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã«åŸ‹ã‚è¾¼ã¾ã‚Œã¦ã„ã‚‹ãŒã€å…±æœ‰ãƒ»å†åˆ©ç”¨ãŒå›°é›£
- ãƒãƒ¼ãƒ å†…ã§ã®ã€Œè‰¯ã„ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã€ã€Œè‰¯ã„ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã€ã®å…±æœ‰æ–‡åŒ–ã‚’ä½œã‚ŠãŸã„
- ã‚¢ã‚»ãƒƒãƒˆã®è©•ä¾¡ãƒ»ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ«ãƒ¼ãƒ—ã‚’å›žã—ãŸã„

**WHOï¼ˆèª°ã®ãŸã‚ï¼‰:**
- AIé–‹ç™ºè€…ãƒ»ç ”ç©¶è€…ï¼ˆå€‹äºº/ãƒãƒ¼ãƒ ï¼‰
- ComfyUIãƒ¦ãƒ¼ã‚¶ãƒ¼
- LLMã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢
- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢

**WHATï¼ˆä½•ã‚’ä½œã‚‹ã‹ï¼‰:**
- Agent/LLMã®ãƒŠãƒ¬ãƒƒã‚¸ãƒ»ã‚¢ã‚»ãƒƒãƒˆå…±æœ‰ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ 
- ã‚¢ã‚»ãƒƒãƒˆç™»éŒ²ãƒ»æ¤œç´¢ãƒ»è©•ä¾¡æ©Ÿèƒ½
- ComfyUIç”»åƒã‹ã‚‰ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿è‡ªå‹•æŠ½å‡ºãƒ»å†åˆ©ç”¨
- ãƒžãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã§ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå…±æœ‰
- è©•ä¾¡ãƒ»ã‚³ãƒ¡ãƒ³ãƒˆæ©Ÿèƒ½ã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ«ãƒ¼ãƒ—

## 2. ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±•é–‹

### ãƒ¡ã‚¤ãƒ³ãƒ•ãƒ­ãƒ¼

1. **ã‚¢ã‚»ãƒƒãƒˆæŠ•ç¨¿ãƒ•ãƒ­ãƒ¼**
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¢ã‚»ãƒƒãƒˆã‚’æ–°è¦ä½œæˆ
   - ã‚¢ã‚»ãƒƒãƒˆã‚¿ã‚¤ãƒ—ã‚’é¸æŠžï¼ˆPrompt / ComfyUI Workflow / Agent Config / Knowledge Documentï¼‰
   - ComfyUIç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ â†’ ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿è‡ªå‹•æŠ½å‡º â†’ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼JSONè¡¨ç¤º
   - Markdownãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ â†’ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
   - ã‚¿ã‚°ãƒ»ã‚«ãƒ†ã‚´ãƒªè¨­å®š
   - å…¬é–‹/éžå…¬é–‹è¨­å®š

2. **ã‚¢ã‚»ãƒƒãƒˆé–²è¦§ãƒ»æ¤œç´¢ãƒ•ãƒ­ãƒ¼**
   - ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ â†’ ã‚¢ã‚»ãƒƒãƒˆä¸€è¦§ï¼ˆã‚«ãƒ¼ãƒ‰è¡¨ç¤ºï¼‰
   - ã‚¿ã‚°ãƒ»ã‚«ãƒ†ã‚´ãƒªã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
   - ã‚¢ã‚»ãƒƒãƒˆè©³ç´°ãƒšãƒ¼ã‚¸ â†’ ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»è©•ä¾¡è¡¨ç¤º
   - ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆç”»åƒã¯ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ä¿æŒã€MDã¯ãã®ã¾ã¾ï¼‰

3. **è©•ä¾¡ãƒ»ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ•ãƒ­ãƒ¼**
   - ã‚¢ã‚»ãƒƒãƒˆè©³ç´°ãƒšãƒ¼ã‚¸ â†’ è©•ä¾¡ï¼ˆ5æ®µéšŽã‚¹ã‚¿ãƒ¼ï¼‰
   - ã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿
   - ãƒ•ã‚©ãƒ¼ã‚¯ï¼ˆã‚¢ã‚»ãƒƒãƒˆã‚’è¤‡è£½ã—ã¦æ”¹è‰¯ï¼‰

4. **è©•ä¾¡å®Ÿè¡Œãƒ•ãƒ­ãƒ¼ï¼ˆLLM/Agentï¼‰**
   - ã‚¢ã‚»ãƒƒãƒˆè©³ç´° â†’ ã€Œè©•ä¾¡å®Ÿè¡Œã€ãƒœã‚¿ãƒ³
   - LLM APIã§ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å®Ÿè¡Œ
   - çµæžœã‚’è‡ªå‹•è©•ä¾¡ï¼ˆãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ã€å“è³ªã‚¹ã‚³ã‚¢ï¼‰
   - è©•ä¾¡å±¥æ­´ã¨ã—ã¦ä¿å­˜

### ã‚µãƒ–ãƒ•ãƒ­ãƒ¼

- ãƒžã‚¤ã‚¢ã‚»ãƒƒãƒˆç®¡ç†ï¼ˆä½œæˆã—ãŸã‚¢ã‚»ãƒƒãƒˆä¸€è¦§ï¼‰
- ãƒ–ãƒƒã‚¯ãƒžãƒ¼ã‚¯æ©Ÿèƒ½
- ã‚¢ã‚»ãƒƒãƒˆã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ï¼ˆv1, v2, v3...ï¼‰

### ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹

- ComfyUIç”»åƒã«ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆ â†’ æ‰‹å‹•å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ è¡¨ç¤º
- å¤§ãã™ãŽã‚‹ãƒ•ã‚¡ã‚¤ãƒ« â†’ 10MBåˆ¶é™
- ä¸é©åˆ‡ãªã‚³ãƒ³ãƒ†ãƒ³ãƒ„ â†’ å ±å‘Šæ©Ÿèƒ½

## 3. ç”»é¢æ§‹æˆï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“é‡è¦–ï¼‰

### ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

```
/ (HomePage)                           - ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒ»æœ€æ–°ã‚¢ã‚»ãƒƒãƒˆ
/assets (AssetLibraryPage)             - ã‚¢ã‚»ãƒƒãƒˆä¸€è¦§ãƒ»æ¤œç´¢
/assets/new (AssetCreatePage)          - ã‚¢ã‚»ãƒƒãƒˆæ–°è¦ä½œæˆ
/assets/:id (AssetDetailPage)          - ã‚¢ã‚»ãƒƒãƒˆè©³ç´°ãƒ»è©•ä¾¡
/my-assets (MyAssetsPage)              - ãƒžã‚¤ã‚¢ã‚»ãƒƒãƒˆç®¡ç†
/bookmarks (BookmarksPage)             - ãƒ–ãƒƒã‚¯ãƒžãƒ¼ã‚¯ä¸€è¦§
```

### å„ç”»é¢ã®ä½“é¨“è¨­è¨ˆ

#### HomePage (/)
- **ç›®çš„**: æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®èˆˆå‘³å–šèµ·ã€æœ€æ–°ã‚¢ã‚»ãƒƒãƒˆã®ç™ºè¦‹
- **è¦ç´ **: Hero Sectionã€æœ€æ–°ã‚¢ã‚»ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ï¼ˆ6ä»¶ï¼‰ã€ã‚«ãƒ†ã‚´ãƒªåˆ¥ã‚¢ã‚»ãƒƒãƒˆã€CTAï¼ˆã‚¢ã‚»ãƒƒãƒˆä½œæˆï¼‰
- **ãƒ‡ã‚¶ã‚¤ãƒ³**: Vibrant Soft UIã€ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³èƒŒæ™¯ï¼ˆãƒ”ãƒ³ã‚¯/ãƒ‘ãƒ¼ãƒ—ãƒ«/ãƒ–ãƒ«ãƒ¼ï¼‰

#### AssetLibraryPage (/assets)
- **ç›®çš„**: ã‚¢ã‚»ãƒƒãƒˆæ¤œç´¢ãƒ»é–²è¦§
- **è¦ç´ **: æ¤œç´¢ãƒãƒ¼ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆã‚¿ã‚°ãƒ»ã‚«ãƒ†ã‚´ãƒªãƒ»ã‚¿ã‚¤ãƒ—ï¼‰ã€ã‚¢ã‚»ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã‚°ãƒªãƒƒãƒ‰ï¼ˆ3åˆ—ï¼‰ã€ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³
- **ãƒ‡ã‚¶ã‚¤ãƒ³**: Card Gridã€hoveråŠ¹æžœã€Badgeï¼ˆã‚¿ã‚°ï¼‰

#### AssetCreatePage (/assets/new)
- **ç›®çš„**: ã‚¢ã‚»ãƒƒãƒˆä½œæˆ
- **è¦ç´ **: ã‚¹ãƒ†ãƒƒãƒ—å¼UIï¼ˆStep 1: ã‚¿ã‚¤ãƒ—é¸æŠž â†’ Step 2: ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ â†’ Step 3: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ â†’ Step 4: å…¬é–‹è¨­å®šï¼‰
- **ãƒ‡ã‚¶ã‚¤ãƒ³**: Progress Barã€FileUploadã€MetadataPreview

#### AssetDetailPage (/assets/:id)
- **ç›®çš„**: ã‚¢ã‚»ãƒƒãƒˆè©³ç´°é–²è¦§ãƒ»è©•ä¾¡ãƒ»å®Ÿè¡Œ
- **è¦ç´ **: ã‚¢ã‚»ãƒƒãƒˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºã€è©•ä¾¡ã‚¹ã‚¿ãƒ¼ã€ã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã€è©•ä¾¡å®Ÿè¡Œãƒœã‚¿ãƒ³
- **ãƒ‡ã‚¶ã‚¤ãƒ³**: 2ã‚«ãƒ©ãƒ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆå·¦: ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã€å³: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ»è©•ä¾¡ï¼‰

#### MyAssetsPage (/my-assets)
- **ç›®çš„**: è‡ªåˆ†ã®ã‚¢ã‚»ãƒƒãƒˆç®¡ç†
- **è¦ç´ **: ã‚¢ã‚»ãƒƒãƒˆä¸€è¦§ï¼ˆç·¨é›†ãƒ»å‰Šé™¤å¯èƒ½ï¼‰ã€çµ±è¨ˆæƒ…å ±ï¼ˆç·ã‚¢ã‚»ãƒƒãƒˆæ•°ã€ç·è©•ä¾¡æ•°ã€å¹³å‡ã‚¹ã‚³ã‚¢ï¼‰
- **ãƒ‡ã‚¶ã‚¤ãƒ³**: Table + Cardã€Stats Overview

#### ASCII WireFrameï¼ˆAssetDetailPageï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TopNavigation                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚                          â”‚ â”‚ Asset Title                  â”‚â”‚
â”‚ â”‚   Asset Preview          â”‚ â”‚ by @username                 â”‚â”‚
â”‚ â”‚   (Image or MD)          â”‚ â”‚                              â”‚â”‚
â”‚ â”‚                          â”‚ â”‚ â­â­â­â­â­ 4.5 (120 ratings) â”‚â”‚
â”‚ â”‚   [Download Button]      â”‚ â”‚                              â”‚â”‚
â”‚ â”‚   [Evaluate Button]      â”‚ â”‚ Tags: #comfyui #sdxl        â”‚â”‚
â”‚ â”‚                          â”‚ â”‚ Category: Workflow           â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                              â”‚â”‚
â”‚                               â”‚ Metadata:                    â”‚â”‚
â”‚                               â”‚ - Model: SDXL 1.0            â”‚â”‚
â”‚                               â”‚ - Steps: 20                  â”‚â”‚
â”‚                               â”‚ - CFG: 7.5                   â”‚â”‚
â”‚                               â”‚                              â”‚â”‚
â”‚                               â”‚ [Fork Asset]                 â”‚â”‚
â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                               â”‚
â”‚ Comments & Ratings                                            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ @user1: Great workflow! â­â­â­â­â­                         â”‚â”‚
â”‚ â”‚ @user2: Works perfectly â­â­â­â­                          â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 4. DBè¨­è¨ˆ

### ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ï¼ˆSQLï¼‰

```sql
-- ã‚¢ã‚»ãƒƒãƒˆã‚¿ã‚¤ãƒ— ENUM
CREATE TYPE asset_type AS ENUM ('prompt', 'comfyui_workflow', 'agent_config', 'knowledge_doc');
CREATE TYPE asset_visibility AS ENUM ('public', 'private', 'unlisted');

-- ã‚¢ã‚»ãƒƒãƒˆåŸºæœ¬æƒ…å ±
CREATE TABLE assets (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  owner_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,

  -- åŸºæœ¬æƒ…å ±
  title TEXT NOT NULL,
  description TEXT,
  asset_type asset_type NOT NULL,
  visibility asset_visibility NOT NULL DEFAULT 'public',

  -- ãƒ•ã‚¡ã‚¤ãƒ«é–¢é€£
  file_id UUID REFERENCES file_metadata(id) ON DELETE SET NULL,
  thumbnail_url TEXT,

  -- ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼ˆJSONBã§æŸ”è»Ÿã«ï¼‰
  metadata JSONB DEFAULT '{}',

  -- çµ±è¨ˆæƒ…å ±
  view_count INTEGER DEFAULT 0,
  download_count INTEGER DEFAULT 0,
  fork_count INTEGER DEFAULT 0,

  -- ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†
  version TEXT DEFAULT '1.0.0',
  parent_asset_id UUID REFERENCES assets(id) ON DELETE SET NULL,

  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- ã‚¢ã‚»ãƒƒãƒˆã‚¿ã‚°ï¼ˆå¤šå¯¾å¤šï¼‰
CREATE TABLE asset_tags (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  asset_id UUID NOT NULL REFERENCES assets(id) ON DELETE CASCADE,
  tag_name TEXT NOT NULL,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(asset_id, tag_name)
);

-- ã‚¢ã‚»ãƒƒãƒˆè©•ä¾¡
CREATE TABLE asset_ratings (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  asset_id UUID NOT NULL REFERENCES assets(id) ON DELETE CASCADE,
  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,

  rating INTEGER NOT NULL CHECK (rating >= 1 AND rating <= 5),
  comment TEXT,

  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW(),

  UNIQUE(asset_id, user_id)
);

-- ã‚¢ã‚»ãƒƒãƒˆè©•ä¾¡å®Ÿè¡Œå±¥æ­´ï¼ˆLLMå®Ÿè¡Œçµæžœï¼‰
CREATE TABLE asset_evaluations (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  asset_id UUID NOT NULL REFERENCES assets(id) ON DELETE CASCADE,
  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,

  -- å®Ÿè¡Œè¨­å®š
  provider TEXT NOT NULL,
  model TEXT NOT NULL,

  -- å®Ÿè¡Œçµæžœ
  response TEXT,
  execution_time_ms INTEGER,
  quality_score NUMERIC(3, 2), -- 0.00 ~ 1.00

  -- ãƒ¡ã‚¿æƒ…å ±
  metadata JSONB DEFAULT '{}',

  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- ãƒ–ãƒƒã‚¯ãƒžãƒ¼ã‚¯
CREATE TABLE asset_bookmarks (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  asset_id UUID NOT NULL REFERENCES assets(id) ON DELETE CASCADE,
  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,

  created_at TIMESTAMPTZ DEFAULT NOW(),

  UNIQUE(asset_id, user_id)
);

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX idx_assets_owner_id ON assets(owner_id);
CREATE INDEX idx_assets_asset_type ON assets(asset_type);
CREATE INDEX idx_assets_visibility ON assets(visibility);
CREATE INDEX idx_assets_created_at ON assets(created_at DESC);
CREATE INDEX idx_asset_tags_tag_name ON asset_tags(tag_name);
CREATE INDEX idx_asset_ratings_asset_id ON asset_ratings(asset_id);
CREATE INDEX idx_asset_evaluations_asset_id ON asset_evaluations(asset_id);
CREATE INDEX idx_asset_bookmarks_user_id ON asset_bookmarks(user_id);
```

### RLS Policyè¨­è¨ˆ

```sql
-- RLSæœ‰åŠ¹åŒ–
ALTER TABLE assets ENABLE ROW LEVEL SECURITY;
ALTER TABLE asset_tags ENABLE ROW LEVEL SECURITY;
ALTER TABLE asset_ratings ENABLE ROW LEVEL SECURITY;
ALTER TABLE asset_evaluations ENABLE ROW LEVEL SECURITY;
ALTER TABLE asset_bookmarks ENABLE ROW LEVEL SECURITY;

-- assets: å…¬é–‹ã‚¢ã‚»ãƒƒãƒˆã¯å…¨å“¡é–²è¦§å¯ã€è‡ªåˆ†ã®ã‚¢ã‚»ãƒƒãƒˆã¯å…¨æ“ä½œå¯
CREATE POLICY "Public assets are viewable by everyone"
  ON assets FOR SELECT
  USING (visibility = 'public' OR owner_id = auth.uid());

CREATE POLICY "Users can insert own assets"
  ON assets FOR INSERT
  WITH CHECK (auth.uid() = owner_id);

CREATE POLICY "Users can update own assets"
  ON assets FOR UPDATE
  USING (auth.uid() = owner_id);

CREATE POLICY "Users can delete own assets"
  ON assets FOR DELETE
  USING (auth.uid() = owner_id);

-- asset_tags: ã‚¢ã‚»ãƒƒãƒˆã®å¯è¦–æ€§ã«å¾“ã†
CREATE POLICY "Tags viewable with asset"
  ON asset_tags FOR SELECT
  USING (
    EXISTS (
      SELECT 1 FROM assets
      WHERE assets.id = asset_tags.asset_id
      AND (assets.visibility = 'public' OR assets.owner_id = auth.uid())
    )
  );

CREATE POLICY "Users can manage tags on own assets"
  ON asset_tags FOR ALL
  USING (
    EXISTS (
      SELECT 1 FROM assets
      WHERE assets.id = asset_tags.asset_id
      AND assets.owner_id = auth.uid()
    )
  );

-- asset_ratings: å…¬é–‹ã‚¢ã‚»ãƒƒãƒˆã®è©•ä¾¡ã¯å…¨å“¡é–²è¦§å¯ã€è‡ªåˆ†ã®è©•ä¾¡ã¯ç·¨é›†å¯
CREATE POLICY "Ratings viewable with asset"
  ON asset_ratings FOR SELECT
  USING (
    EXISTS (
      SELECT 1 FROM assets
      WHERE assets.id = asset_ratings.asset_id
      AND (assets.visibility = 'public' OR assets.owner_id = auth.uid())
    )
  );

CREATE POLICY "Users can insert own ratings"
  ON asset_ratings FOR INSERT
  WITH CHECK (auth.uid() = user_id);

CREATE POLICY "Users can update own ratings"
  ON asset_ratings FOR UPDATE
  USING (auth.uid() = user_id);

CREATE POLICY "Users can delete own ratings"
  ON asset_ratings FOR DELETE
  USING (auth.uid() = user_id);

-- asset_evaluations: åŒæ§˜
CREATE POLICY "Evaluations viewable with asset"
  ON asset_evaluations FOR SELECT
  USING (
    EXISTS (
      SELECT 1 FROM assets
      WHERE assets.id = asset_evaluations.asset_id
      AND (assets.visibility = 'public' OR assets.owner_id = auth.uid())
    )
  );

CREATE POLICY "Users can insert own evaluations"
  ON asset_evaluations FOR INSERT
  WITH CHECK (auth.uid() = user_id);

-- asset_bookmarks: è‡ªåˆ†ã®ãƒ–ãƒƒã‚¯ãƒžãƒ¼ã‚¯ã®ã¿é–²è¦§ãƒ»ç·¨é›†å¯
CREATE POLICY "Users can manage own bookmarks"
  ON asset_bookmarks FOR ALL
  USING (auth.uid() = user_id);
```

## 5. ä½¿ç”¨ã™ã‚‹Akatsukiæ©Ÿèƒ½

### å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½ï¼ˆå†åˆ©ç”¨ï¼‰

- âœ… `FileUpload` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- âœ… `usePublicProfile` ãƒ•ãƒƒã‚¯
- âœ… `PublicStorageService` / `PrivateStorageService`
- âœ… `EdgeFunctionService`
- âœ… `AuthGuard`, `Layout`, `PrivateLayout`
- âœ… shadcn/ui ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆCard, Button, Badge, Input, Textarea, Select, Progress, etc.ï¼‰
- âœ… React Queryï¼ˆCustom Hookçµ±åˆï¼‰

### æ–°è¦ä½œæˆãŒå¿…è¦ãªæ©Ÿèƒ½

- ðŸ“ ComfyUIç”»åƒãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºï¼ˆEdge Functionï¼‰
- ðŸ“ Markdownãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½
- ðŸ“ LLMè©•ä¾¡å®Ÿè¡Œï¼ˆæ—¢å­˜ ai-chat ã‚’æ´»ç”¨ï¼‰
- ðŸ“ è©•ä¾¡ã‚¹ã‚³ã‚¢è‡ªå‹•è¨ˆç®—

## 6. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å±¤

### Models
- `Asset.ts` - ã‚¢ã‚»ãƒƒãƒˆåŸºæœ¬æƒ…å ±
- `AssetRating.ts` - è©•ä¾¡æƒ…å ±
- `AssetEvaluation.ts` - è©•ä¾¡å®Ÿè¡Œå±¥æ­´
- `AssetBookmark.ts` - ãƒ–ãƒƒã‚¯ãƒžãƒ¼ã‚¯

### Repositories
- `AssetRepository.ts` - ã‚¢ã‚»ãƒƒãƒˆCRUDï¼ˆã‚¿ã‚°ãƒ»è©•ä¾¡å«ã‚€ï¼‰
- `AssetRatingRepository.ts` - è©•ä¾¡CRUD
- `AssetEvaluationRepository.ts` - è©•ä¾¡å®Ÿè¡Œå±¥æ­´CRUD
- `AssetBookmarkRepository.ts` - ãƒ–ãƒƒã‚¯ãƒžãƒ¼ã‚¯CRUD

### Services
- `ComfyUIMetadataService.ts` - ComfyUIç”»åƒãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºï¼ˆEdge Functionå‘¼ã³å‡ºã—ï¼‰
- `AssetEvaluationService.ts` - LLMè©•ä¾¡å®Ÿè¡Œï¼ˆai-chatæ´»ç”¨ï¼‰

### Hooks
- `useAssets.ts` - ã‚¢ã‚»ãƒƒãƒˆä¸€è¦§å–å¾—ï¼ˆReact Queryï¼‰
- `useAsset.ts` - ã‚¢ã‚»ãƒƒãƒˆè©³ç´°å–å¾—ï¼ˆReact Queryï¼‰
- `useCreateAsset.ts` - ã‚¢ã‚»ãƒƒãƒˆä½œæˆï¼ˆMutationï¼‰
- `useUpdateAsset.ts` - ã‚¢ã‚»ãƒƒãƒˆæ›´æ–°ï¼ˆMutationï¼‰
- `useDeleteAsset.ts` - ã‚¢ã‚»ãƒƒãƒˆå‰Šé™¤ï¼ˆMutationï¼‰
- `useAssetRatings.ts` - è©•ä¾¡ä¸€è¦§å–å¾—
- `useCreateRating.ts` - è©•ä¾¡ä½œæˆï¼ˆMutationï¼‰
- `useAssetEvaluations.ts` - è©•ä¾¡å®Ÿè¡Œå±¥æ­´å–å¾—
- `useExecuteEvaluation.ts` - è©•ä¾¡å®Ÿè¡Œï¼ˆMutationï¼‰
- `useBookmarks.ts` - ãƒ–ãƒƒã‚¯ãƒžãƒ¼ã‚¯ä¸€è¦§å–å¾—
- `useToggleBookmark.ts` - ãƒ–ãƒƒã‚¯ãƒžãƒ¼ã‚¯åˆ‡ã‚Šæ›¿ãˆï¼ˆMutationï¼‰

### Components
- `AssetCard.tsx` - ã‚¢ã‚»ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ï¼ˆGridè¡¨ç¤ºç”¨ï¼‰
- `AssetPreview.tsx` - ã‚¢ã‚»ãƒƒãƒˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆç”»åƒ or Markdownï¼‰
- `MetadataDisplay.tsx` - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º
- `RatingStars.tsx` - è©•ä¾¡ã‚¹ã‚¿ãƒ¼è¡¨ç¤ºãƒ»å…¥åŠ›
- `CommentList.tsx` - ã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§
- `AssetFilters.tsx` - ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆã‚¿ã‚°ãƒ»ã‚«ãƒ†ã‚´ãƒªï¼‰
- `AssetCreateFlow.tsx` - ã‚¹ãƒ†ãƒƒãƒ—å¼ä½œæˆãƒ•ãƒ­ãƒ¼

### Pages
- `HomePage.tsx` - ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒ»æœ€æ–°ã‚¢ã‚»ãƒƒãƒˆ
- `AssetLibraryPage.tsx` - ã‚¢ã‚»ãƒƒãƒˆä¸€è¦§ãƒ»æ¤œç´¢
- `AssetCreatePage.tsx` - ã‚¢ã‚»ãƒƒãƒˆæ–°è¦ä½œæˆ
- `AssetDetailPage.tsx` - ã‚¢ã‚»ãƒƒãƒˆè©³ç´°ãƒ»è©•ä¾¡
- `MyAssetsPage.tsx` - ãƒžã‚¤ã‚¢ã‚»ãƒƒãƒˆç®¡ç†
- `BookmarksPage.tsx` - ãƒ–ãƒƒã‚¯ãƒžãƒ¼ã‚¯ä¸€è¦§

### Edge Functionsï¼ˆæ–°è¦ï¼‰
- `extract-comfyui-metadata` - ComfyUIç”»åƒã‹ã‚‰ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æŠ½å‡º

## 7. å®Ÿè£…ã‚¹ãƒ†ãƒƒãƒ—

### Phase 1: DBè¨­è¨ˆãƒ»Migration
- [ ] Migrationä½œæˆï¼ˆãƒ†ãƒ¼ãƒ–ãƒ«ãƒ»RLSãƒ»ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼‰
- [ ] Migrationé©ç”¨ãƒ»ç¢ºèª

### Phase 2: Model/Repositoryå±¤
- [ ] Asset Model
- [ ] AssetRating Model
- [ ] AssetEvaluation Model
- [ ] AssetBookmark Model
- [ ] å„Repositoryå®Ÿè£…

### Phase 3: Serviceå±¤
- [ ] ComfyUIMetadataServiceï¼ˆEdge Functionå«ã‚€ï¼‰
- [ ] AssetEvaluationService

### Phase 4: Hookå±¤
- [ ] useAssets
- [ ] useAsset
- [ ] useCreateAsset / useUpdateAsset / useDeleteAsset
- [ ] useAssetRatings / useCreateRating
- [ ] useAssetEvaluations / useExecuteEvaluation
- [ ] useBookmarks / useToggleBookmark

### Phase 5: Componentå±¤
- [ ] AssetCard
- [ ] AssetPreview
- [ ] MetadataDisplay
- [ ] RatingStars
- [ ] CommentList
- [ ] AssetFilters
- [ ] AssetCreateFlow

### Phase 6: Pageå±¤
- [ ] HomePage
- [ ] AssetLibraryPage
- [ ] AssetCreatePage
- [ ] AssetDetailPage
- [ ] MyAssetsPage
- [ ] BookmarksPage

### Phase 7: Routingè¨­å®š
- [ ] App.tsx ã«ãƒ«ãƒ¼ãƒˆè¿½åŠ 

### Phase 8: å‹•ä½œç¢ºèª
- [ ] workspace/ ã§ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
- [ ] å„ç”»é¢ã®å‹•ä½œç¢ºèª

## 8. é‡è¦ãªè¨­è¨ˆåˆ¤æ–­

### ComfyUIãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºã«ã¤ã„ã¦

**æ–¹é‡:**
- PNGç”»åƒã®EXIFãƒ‡ãƒ¼ã‚¿ã« `workflow` ã¨ã„ã†ã‚­ãƒ¼ã§JSONæ–‡å­—åˆ—ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹
- Edge Functionã§ç”»åƒã‚’èª­ã¿è¾¼ã¿ã€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ‘ãƒ¼ã‚¹
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§æ•´å½¢ã—ã¦è¡¨ç¤º

**ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå€™è£œ:**
- Denoæ¨™æº–æ©Ÿèƒ½ or `pngjs` / `exif-parser`

### ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¿æŒ

**æ–¹é‡:**
- ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ™‚ã¯å…ƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãã®ã¾ã¾è¿”ã™ï¼ˆSigned URLçµŒç”±ï¼‰
- Supabase Storage ã«ä¿å­˜ã•ã‚ŒãŸæ™‚ç‚¹ã§ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã¯ä¿æŒã•ã‚Œã¦ã„ã‚‹

### LLMè©•ä¾¡å®Ÿè¡Œ

**æ–¹é‡:**
- æ—¢å­˜ã® `ai-chat` Edge Functionã‚’æ´»ç”¨
- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚¢ã‚»ãƒƒãƒˆã®å ´åˆ: ãã®ã¾ã¾LLMã«é€ä¿¡ â†’ ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ãƒ»å“è³ªã‚’è©•ä¾¡
- è©•ä¾¡ã‚¹ã‚³ã‚¢ã¯åˆ¥é€”ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…ï¼ˆæ–‡å­—æ•°ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ã€etc.ï¼‰

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

- RLS: å…¬é–‹ã‚¢ã‚»ãƒƒãƒˆã¯å…¨å“¡é–²è¦§å¯ã€éžå…¬é–‹ã¯æœ¬äººã®ã¿
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰: Public Storageã‚’ä½¿ç”¨ï¼ˆå…¬é–‹ã‚¢ã‚»ãƒƒãƒˆæƒ³å®šï¼‰
- ä¸é©åˆ‡ã‚³ãƒ³ãƒ†ãƒ³ãƒ„: å ±å‘Šæ©Ÿèƒ½ã¯ä»Šå›žã‚¹ã‚³ãƒ¼ãƒ—å¤–ï¼ˆå°†æ¥å®Ÿè£…ï¼‰

---

**è¨­è¨ˆå®Œäº†ï¼æ¬¡ã¯æ—¢å­˜å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ã®èª¿æŸ»ã«é€²ã¿ã¾ã™ã€‚**
